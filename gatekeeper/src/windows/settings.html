<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Settings</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="window-wrap">
    <div class="card">
      <div class="header">
        <div class="logo"><img src="../assets/icon.svg" alt="Gatekeeper logo" /></div>
        <div>
          <h2>Settings</h2>
          <div class="sub">Configure API keys and blocked apps</div>
        </div>
      </div>

      <div class="section">
        <h3>Chatbot API Key</h3>
        <div class="field-wrap">
          <label>Google Gemini API Key</label>
          <input type="password" id="apiKey" placeholder="Enter API key" />

          <div style="margin-top:10px;display:flex;gap:8px;">
            <button id="saveApiKey" class="btn">Save API Key</button>
            <button id="clearApiKey" class="btn secondary">Clear</button>
          </div>
          <div id="apiStatus" class="status" aria-live="polite"></div>
        </div>
      </div>

      <!-- Model selection removed -->

      <!-- Removed "Available in Dropdown" section: home app selector now shows only blocked/apps with policies -->

      <div class="section">
        <h3>Restricted Apps & Policies</h3>
        <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;align-items:flex-end;">
          <div class="field-wrap" style="min-width:220px;">
            <label>Add app to restricted list</label>
            <select id="addAppSelect"></select>
          </div>
          <button id="addBlocked" class="btn">Add Blocked App</button>

          <div style="flex-basis:100%;height:8px"></div>

          <div style="margin-top:10px;width:100%">
            <label>Restricted apps</label>
            <div id="blockedList"
              style="margin-top:6px;padding:6px;border:1px solid #eef2f8;border-radius:8px;background:#fff">
            </div>
          </div>
        </div>
        <div id="status" class="status" aria-live="polite"></div>
      </div>
    </div>
  </div>

  <div id="policyModal"
    style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:999;background:rgba(15,23,42,0.45);">
    <div
      style="width:min(520px,92vw);background:#fff;border-radius:12px;padding:16px 18px;box-shadow:0 20px 50px rgba(15,23,42,0.25);">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
        <div style="font-weight:600;font-size:16px;">Policy Settings</div>
        <button id="policyClose" class="btn secondary">Close</button>
      </div>
      <div id="policyAppName" style="font-size:13px;color:var(--muted);margin-bottom:12px;"></div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
        <div class="field-wrap">
          <label>Daily max minutes</label>
          <input type="number" id="policyDaily" min="1" />
        </div>
        <div class="field-wrap">
          <label>Max per request</label>
          <input type="number" id="policyPerReq" min="1" />
        </div>
      </div>

      <div style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end;">
        <button id="policyRemove" class="btn secondary">Remove Policy</button>
        <button id="policySave" class="btn">Save Policy</button>
      </div>
    </div>
  </div>

  <script src="settings.js"></script>
</body>

</html>